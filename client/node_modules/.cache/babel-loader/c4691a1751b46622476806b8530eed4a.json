{"ast":null,"code":"import _objectSpread from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/akash/antstack/backend/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import ReactSearchBox from'react-search-box';import'./App.css';import axios from'axios';import _ from\"lodash\";var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.getData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result,formatData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('http://localhost:5000');case 2:result=_context.sent;formatData=result.data.map(function(row,index){return{key:\"\".concat(index+1),value:row.name};});_this.setState({data:formatData});console.log(\"mounted\",formatData);case 6:case\"end\":return _context.stop();}}},_callee);}));_this.handleChange=function(event){console.log(event.target);var key=event.target.name;var state=_this.state;if(key===\"couponName\")_this.setState(_objectSpread(_objectSpread({},state),{},{couponName:event.target.value}));if(key===\"couponType\")_this.setState(_objectSpread(_objectSpread({},state),{},{couponType:event.target.value}));if(key===\"expiryDate\")_this.setState(_objectSpread(_objectSpread({},state),{},{expiryDate:event.target.value}));if(key===\"minPurchase\")_this.setState(_objectSpread(_objectSpread({},state),{},{minPurchase:event.target.value}));if(key===\"discount\")_this.setState(_objectSpread(_objectSpread({},state),{},{discount:event.target.value}));};_this.handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var body,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();console.log(\"i'm in dada\");body={name:_this.state.couponName,type:_this.state.couponType,endDate:_this.state.expiryDate,minAmt:_this.state.minPurchase,discount:_this.state.discount};console.log(body);_context2.next=6;return axios.post('http://localhost:5000/coupon/create',body);case 6:result=_context2.sent;console.log(result.data);case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handleSelect=function(event){event.preventDefault();};_this.state={cartAmount:0,data:[],coupons:[],valueAfterDiscount:0,couponName:'',couponType:'',expiryDate:'',minPurchase:0,discount:0,couponApplied:false};return _this;}_createClass(App,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get('http://localhost:5000');case 2:result=_context3.sent;this.setState({coupons:result.data});console.log(this.state.coupons,\"in mount\");case 5:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"renderContent\",value:function renderContent(){return _.map(this.state.coupons,function(coupon){return/*#__PURE__*/React.createElement(\"div\",{className:\"card blue-grey darken-1\",key:coupon._id},/*#__PURE__*/React.createElement(\"div\",{className:\"card-content\"},/*#__PURE__*/React.createElement(\"span\",{className:\"card-title\"},coupon.name),/*#__PURE__*/React.createElement(\"p\",null,coupon.minAmt),/*#__PURE__*/React.createElement(\"p\",null,coupon.discount),/*#__PURE__*/React.createElement(\"p\",null,coupon.type),/*#__PURE__*/React.createElement(\"p\",{className:\"right\"},\"Expires On : \",new Date(coupon.endDate).toLocaleDateString())));});}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",{style:{padding:'50px'}},/*#__PURE__*/React.createElement(\"div\",{className:\"card-content\"},/*#__PURE__*/React.createElement(ReactSearchBox,{placeholder:\"Search for coupon\",data:this.state.data,onSelect:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(record){var discount;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(record.value,_this2.state.cartAmount);_context4.next=3;return axios.post('http://localhost:5000/coupon',{cartAmount:_this2.state.cartAmount,couponCode:record.value});case 3:discount=_context4.sent;console.log(\"discount\",discount.data);_this2.setState(_objectSpread(_objectSpread({},_this2.state),{},{valueAfterDiscount:discount.data.valueAfterFlat,couponApplied:discount.data.valid}));case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref3.apply(this,arguments);};}(),onFocus:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log('This function is called when is focussed');_context5.next=3;return _this2.getData();case 3:case\"end\":return _context5.stop();}}},_callee5);})),onChange:function onChange(value){return console.log(value);},fuseConfigs:{threshold:0.05},value:this.state.couponCode}),/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){_this2.setState({couponApplied:false,data:[]});}},\"Reset\")),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'center',width:'50%',margin:'0 auto',flexDirection:'row',display:'flex',justifyContent:'space-evenly',paddingTop:'50px'}},/*#__PURE__*/React.createElement(\"button\",{className:\"minus\",onClick:function onClick(e){e.preventDefault();if(!_this2.state.cartAmount<=0)_this2.setState({cartAmount:_this2.state.cartAmount-50});}},\"-\"),/*#__PURE__*/React.createElement(\"button\",{className:\"plus\",onClick:function onClick(e){e.preventDefault();_this2.setState({cartAmount:_this2.state.cartAmount+50});}},\" +\"),/*#__PURE__*/React.createElement(\"div\",null,this.state.couponApplied?/*#__PURE__*/React.createElement(\"div\",null,\"valueAfterDiscount = \",this.state.valueAfterDiscount===this.state.cartAmount?/*#__PURE__*/React.createElement(\"p\",null,\"coupon code is expired\"):this.state.valueAfterDiscount):'',/*#__PURE__*/React.createElement(\"div\",null,\"cartAmount = \",this.state.cartAmount))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",null,\"Create Coupon\"),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"label\",null,\"Coupon Name\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"couponName\",name:\"couponName\",value:this.state.couponName,onChange:function onChange(e){_this2.handleChange(e);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"label\",null,\"Type\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"couponType\",name:\"couponType\",value:this.state.couponType,onChange:function onChange(e){_this2.handleChange(e);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"label\",null,\"Expiry Date\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{type:\"date\",id:\"expiryDate\",name:\"expiryDate\",value:this.state.expiryDate,onChange:function onChange(e){_this2.handleChange(e);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"label\",null,\"Minimum Purchase Amount\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",id:\"minPurchase\",name:\"minPurchase\",value:this.state.minPurchase,onChange:function onChange(e){_this2.handleChange(e);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"label\",null,\"Discount Amount\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",id:\"discount\",name:\"discount\",value:this.state.discount,onChange:function onChange(e){_this2.handleChange(e);}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",onClick:/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_this2.handleSubmit(e);case 1:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x3){return _ref5.apply(this,arguments);};}()},\" Create \"))),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h5\",null,\"CouponS\"),this.renderContent()));}}]);return App;}(Component);export{App as default};","map":{"version":3,"sources":["/home/akash/antstack/backend/client/src/App.js"],"names":["React","Component","ReactSearchBox","axios","_","App","props","getData","get","result","formatData","data","map","row","index","key","value","name","setState","console","log","handleChange","event","target","state","couponName","couponType","expiryDate","minPurchase","discount","handleSubmit","preventDefault","body","type","endDate","minAmt","post","handleSelect","cartAmount","coupons","valueAfterDiscount","couponApplied","coupon","_id","Date","toLocaleDateString","padding","record","couponCode","valueAfterFlat","valid","threshold","textAlign","width","margin","flexDirection","display","justifyContent","paddingTop","e","renderContent"],"mappings":"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","sourcesContent":["\nimport React, { Component } from 'react'\nimport ReactSearchBox from 'react-search-box'\nimport './App.css'\nimport axios from 'axios'\nimport _ from \"lodash\";\n\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      cartAmount: 0,\n      data: [],\n      coupons: [],\n      valueAfterDiscount: 0,\n      couponName: '',\n      couponType: '',\n      expiryDate: '',\n      minPurchase: 0,\n      discount: 0,\n      couponApplied: false\n    }\n  }\n  async componentDidMount() {\n    const result = await axios.get('http://localhost:5000')\n    this.setState({ coupons: result.data })\n    console.log(this.state.coupons, \"in mount\");\n  }\n  renderContent() {\n    return _.map(\n      this.state.coupons,\n      (coupon) => {\n        return (\n          <div className=\"card blue-grey darken-1\" key={coupon._id}>\n            <div className=\"card-content\">\n              <span className=\"card-title\">{coupon.name}</span>\n              <p>{coupon.minAmt}</p>\n              <p>{coupon.discount}</p>\n              <p>{coupon.type}</p>\n              <p className=\"right\">\n                Expires On : {new Date(coupon.endDate).toLocaleDateString()}\n              </p>\n            </div>\n          </div>\n        );\n      }\n    );\n  }\n\n  getData = async () => {\n    const result = await axios.get('http://localhost:5000')\n    let formatData = result.data.map((row, index) => {\n      return {\n        key: `${index + 1}`,\n        value: row.name\n      }\n    })\n    this.setState({ data: formatData })\n    console.log(\"mounted\", formatData);\n  }\n\n  handleChange = event => {\n    console.log(event.target);\n    const key = event.target.name\n    let state = this.state\n    if (key === \"couponName\")\n      this.setState({ ...state, couponName: event.target.value });\n    if (key === \"couponType\")\n      this.setState({ ...state, couponType: event.target.value });\n    if (key === \"expiryDate\")\n      this.setState({ ...state, expiryDate: event.target.value });\n    if (key === \"minPurchase\")\n      this.setState({ ...state, minPurchase: event.target.value });\n    if (key === \"discount\")\n      this.setState({ ...state, discount: event.target.value });\n  }\n\n  handleSubmit = async (event) => {\n    event.preventDefault();\n    console.log(\"i'm in dada\");\n    const body = {\n      name: this.state.couponName,\n      type: this.state.couponType,\n      endDate: this.state.expiryDate,\n      minAmt: this.state.minPurchase,\n      discount: this.state.discount\n    }\n    console.log(body);\n    const result = await axios.post('http://localhost:5000/coupon/create', body)\n    console.log(result.data);\n\n  }\n  handleSelect = event => {\n    event.preventDefault();\n  }\n\n  render() {\n    return (\n      <div style={{ padding: '50px' }}>\n        <div className=\"card-content\">\n          <ReactSearchBox\n            placeholder=\"Search for coupon\"\n            data={this.state.data}\n            onSelect={async (record) => {\n              console.log(record.value, this.state.cartAmount)\n              const discount = await axios.post('http://localhost:5000/coupon', { cartAmount: this.state.cartAmount, couponCode: record.value })\n              console.log(\"discount\", discount.data);\n\n              this.setState({ ...this.state, valueAfterDiscount: discount.data.valueAfterFlat, couponApplied: discount.data.valid })\n            }}\n            onFocus={async () => {\n              console.log('This function is called when is focussed')\n              await this.getData()\n            }}\n            onChange={value => console.log(value)}\n            fuseConfigs={{\n              threshold: 0.05,\n            }}\n            value={this.state.couponCode}\n            \n          />\n          <button onClick={()=>{\n            this.setState({couponApplied:false,  data:[]})\n          }}>\n            Reset\n      </button>\n        </div>\n\n        <div style={{ textAlign: 'center', width: '50%', margin: '0 auto', flexDirection: 'row', display: 'flex', justifyContent: 'space-evenly', paddingTop: '50px' }}>\n\n          <button className=\"minus\" onClick={(e) => {\n            e.preventDefault()\n            if (!this.state.cartAmount <= 0)\n              this.setState({\n                cartAmount: this.state.cartAmount - 50\n              })\n          }}>-</button>\n          <button className=\"plus\" onClick={(e) => {\n            e.preventDefault()\n            this.setState({\n              cartAmount: this.state.cartAmount + 50\n            })\n          }}> +</button>\n\n          <div>\n            {this.state.couponApplied ?\n              <div>\n                valueAfterDiscount = {this.state.valueAfterDiscount===this.state.cartAmount ? <p>coupon code is expired</p> : this.state.valueAfterDiscount}\n              </div> : ''}\n            <div>cartAmount = {this.state.cartAmount}\n            </div>\n          </div>\n        </div>\n\n        <div>\n          <h2>Create Coupon</h2>\n\n          <form>\n            <label >Coupon Name</label><br />\n            <input type=\"text\" id=\"couponName\" name=\"couponName\" value={this.state.couponName}\n              onChange={(e) => {\n                this.handleChange(e)\n              }}\n            /><br />\n            <label >Type</label><br />\n            <input type=\"text\" id=\"couponType\" name=\"couponType\" value={this.state.couponType}\n              onChange={(e) => {\n                this.handleChange(e)\n              }} /><br />\n            <label >Expiry Date</label><br />\n            <input type=\"date\" id=\"expiryDate\" name=\"expiryDate\" value={this.state.expiryDate}\n              onChange={(e) => {\n                this.handleChange(e)\n              }} /><br />\n            <label>Minimum Purchase Amount</label><br />\n            <input type=\"number\" id=\"minPurchase\" name=\"minPurchase\" value={this.state.minPurchase}\n              onChange={(e) => {\n                this.handleChange(e)\n              }} /><br />\n            <label >Discount Amount</label><br />\n            <input type=\"number\" id=\"discount\" name=\"discount\" value={this.state.discount}\n              onChange={(e) => {\n                this.handleChange(e)\n              }} /><br /><br />\n            <button type=\"submit\" onClick={async (e) => { this.handleSubmit(e) }}> Create </button>\n\n          </form>\n        </div>\n\n        <div>\n          <h5>CouponS</h5>\n          {this.renderContent()}\n        </div>\n\n\n      </div>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}